ENGETO - Projekt SQL Ð datov‡ analùzaAnalùza ekonomickùch datTento projekt analyzuje vùvoj mezd, cen potravin a HDP v ‰eskŽ republice v próbžhu sledovanŽho obdob’. Data poch‡z’ z nžkolika datab‡z’ obsahuj’c’ch informace o prómžrnùch mzd‡ch, cen‡ch potravin a makroekonomickùch ukazatel’ch, v‹etnž HDP. Hlavn’m c’lem je odpovždžt na nžkolik kl’‹ovùch ot‡zek tùkaj’c’ch se ekonomickùch trendó a souvislost’ mezi faktory. C’l projektu: *	analyzovat vztah mezi vùvojem mezd a cen jednotlivùch kategori’ potravin v ‰eskŽ republice za sledovanŽ obdob’ *	zjistit, zda se mzdy vyv’jej’ rovnomžrnž napÞ’‹ hospod‡Þskùmi odvžtv’mi *	posoudit  vliv prómžrnŽho pÞ’jmu na dostupnost vybranùch kategori’ potravin*	ovžÞit hypotŽzu, ìe vùäe HDP m‡ vliv na zmžnu mezd a cen potravin.  Hlavn’ vùzkumnŽ ot‡zky: 1.	Rostou v próbžhu let mzdy ve väech odvžtv’ch, nebo v nžkterùch klesaj’?2.	Kolik je moìnŽ si koupit litró mlŽka a kilogramó chleba za prvn’ a posledn’ srovnatelnŽ obdob’ v dostupnùch datech cen a mezd?3.	Kter‡ kategorie potravin zdraìuje nejpomaleji (je u n’ nejniìä’ percentu‡ln’ meziro‹n’ n‡róst)?4.	Existuje rok, ve kterŽm byl meziro‹n’ n‡róst cen potravin vùraznž vyää’ neì róst mezd (vžtä’ neì 10 %)?5.	M‡ vùäka HDP vliv na zmžny ve mzd‡ch a cen‡ch potravin? Neboli, pokud HDP vzroste vùraznžji v jednom roce, projev’ se to na cen‡ch potravin ‹i mzd‡ch ve stejnŽm nebo n‡sleduj’c’m roce vùraznžjä’m róstem?Dataset a tabulky:Pouìit‡ data poch‡zej’ z veÞejnùch zdrojó, z Port‡lu otevÞenùch dat ‰R a zahrnuj’:1.	Hlavn’ tabulka: t_cathy_markova_project_sql_primary_final Obsahuje  data o mzd‡ch a cen‡ch za sledovanŽ obdob’ v ‰eskŽ republice:*	payroll_year Ð rok vùplaty mezd*	industry Ð hospod‡ÞskŽ odvžtv’*	average_wages Ð prómžrn‡ hrub‡ mzda v tis. K‹*	food_code Ð k—d kategorie potravin*	food_category Ð n‡zev kategorie potravin*	food_price Ð prómžrn‡ cena danŽ kategorie potravin*	price_value Ð po‹et mžrnŽ jednotky ceny, napÞ. 1*	price_unit Ð mžrn‡ jednotka ceny, napÞ. kg*	price_measured from, price_measured_to Ð po‹‡te‹n’ a kone‹nŽ datum mžÞen’ ceny2.	 Sekund‡rn’  tabulka: t_cathy_markova_project_sql_secondary_final ÐObsahuje doplËuj’c’ ekonomickŽ œdaje :*	GDP Ð hrubù dom‡c’ produkt*	GINI Ð statistick‡ m’ra nerovnosti v rozdžlen’ pÞ’jmó nebo bohatstv’ v ur‹itŽ populaci*	population Ð po‹et obyvatelstva Uk‡zka pouìitŽho SQL skriptu:--- ot‡zka ‹.1: Rostou v próbžhu let mzdy ve väech odvžtv’ch, nebo v nžkterùch klesaj’?selectpayroll_year,industry,    AVG(average_wages) AS average_wage,    LAG(AVG(average_wages)) OVER (PARTITION BY industry ORDER BY payroll_year) AS previous_year_wages,    ((AVG(average_wages) - LAG(AVG(average_wages)) OVER (PARTITION BY industry ORDER BY payroll_year)) /     nullif(LAG(AVG(average_wages)) OVER (PARTITION BY industry ORDER BY payroll_year) * 100)) AS wage_growth_percentage,    case     	when (AVG(average_wages) - LAG(AVG(average_wages)) OVER (PARTITION BY industry ORDER BY payroll_year))   > 0 then 'growth'    	else 'decline'    end as trend      FROM t_katerina_markova_project_sql_primary_final tmpfGROUP BY payroll_year, industryORDER BY industry, payroll_year;WITH cte_wage_analysis AS ( -- analùza vùvoje mezd    SELECT        payroll_year,        industry,        round(AVG(average_wages) :: numeric) AS average_wage,        round(LAG(AVG(average_wages)) OVER (PARTITION BY industry             ORDER BY payroll_year        ) :: numeric) AS previous_year_wages,       round((AVG(average_wages) - LAG(AVG(average_wages)) OVER (            PARTITION BY industry             ORDER BY payroll_year        )) / LAG(AVG(average_wages)) OVER (            PARTITION BY industry             ORDER BY payroll_year        ) * 100, 3) AS wage_growth_percentage,        CASE             WHEN (AVG(average_wages) - LAG(AVG(average_wages)) OVER (                PARTITION BY industry                 ORDER BY payroll_year            )) > 0 THEN 'growth'            ELSE 'decline'        END AS trend    FROM t_katerina_markova_project_sql_primary_final tmpf    GROUP BY payroll_year, industry)SELECT *FROM cte_wage_analysisWHERE previous_year_wages IS NOT NULLORDER BY trend, industry, payroll_year;Metodologie analùzyAnalùza byla provedena pomoc’ SQL dotazovac’ho jazyka s vyuìit’m rela‹n’ datab‡ze. PouìitŽ techniky: 1. ‰asovŽ porovn‡n’ dat*	Vyuìit’ LAG() a LEAD() pro porovn‡n’ hodnot mezi jednotlivùmi roky.*	AVG() pro vùpo‹et prómžrnùch hodnot mezd a cen potravin.*	EXTRACT(YEAR FROM date_column) pro seskupen’ dat podle rokó.2. Vùvoj mezd v odvžtv’ch*	PARTITION BY industry s LAG() k porovn‡n’ meziro‹n’ch zmžn.*	CASE WHEN pro kategorizaci na "growth" (róst) a "decline" (pokles).3. Koupžschopnost obyvatelstva*	Vùpo‹et kupn’ s’ly (FLOOR(average_wage / avg_food_price)).4. Identifikace nejpomalejä’ho róstu cen potravin*	ROW_NUMBER() OVER (PARTITION BY food_category ORDER BY percentage_price_change ASC) pro ur‹en’ nejniìä’ho róstu cen.5. Vliv HDP na mzdy a ceny potravin*	Spojen’ tabulek t_cathy_markova_project_sql_primary_final a t_cathy_markova_project_sql_secondary_final.*	Vùpo‹et meziro‹n’ho róstu HDP pomoc’ LAG() a porovn‡n’ s róstem mezd a cen. Struktura vùstupn’ho souboru Vùstupn’ soubor m‡ podobu SQL skriptu generuj’c’ho vstupn’ tabulky, mezivùsledky i vùslednŽ tabulky. Shrnut’ hlavn’ch zjiätžn’*	Mzdy dlouhodobž rostou ve väech sledovanùch odvžtv’ch, ale v nžkterùch letech doch‡z’ ke kr‡tkodobùm poklesóm. *	 Koupžschopnost se zvùäila Ð v roce 2018 bylo moìnŽ koupit v’ce mlŽka i chleba neì v roce 2006. *	Nejmenä’ meziro‹n’ róst mžla kategorie jakostn’ho b’lŽho v’na (2,70 % ro‹nž). Nejvžtä’ pokles cen zaznamenala raj‹ata ‹erven‡ kulat‡ v roce 2017 (-30,28 %).*	Ve sledovanŽm obdob’ nikdy nedoälo k róstu cen potravin o v’ce neì 10 % nad róst mezd. *	Róst HDP m‡ ur‹itou souvislost s róstem mezd, ale ne vìdy se projev’ ve stejnŽm roce. Moìn‡ omezen’ a doporu‹en’*	Analùza vlivu HDP na mzdy a ceny byla moìn‡ pouze pro ‰R kvóli nedostupnosti dat pro jinŽ zemž.*	Budouc’ vùzkum by mohl zahrnout äirä’ ekonomickŽ faktory, napÞ’klad inflaci nebo zmžny v produktivitž pr‡ce.Autor:KateÞina Markov‡