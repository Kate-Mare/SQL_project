ENGETO - Projekt SQL – datová analýzaAnalýza ekonomických datTento projekt analyzuje vývoj mezd, cen potravin a HDP v České republice v průběhu sledovaného období. Data pochází z několika databází obsahujících informace o průměrných mzdách, cenách potravin a makroekonomických ukazatelích, včetně HDP. Hlavním cílem je odpovědět na několik klíčových otázek týkajících se ekonomických trendů a souvislostí mezi faktory.Cíl projektu: • analyzovat vztah mezi vývojem mezd a cen jednotlivých kategorií potravin v České republice za sledované období • zjistit, zda se mzdy vyvíjejí rovnoměrně napříč hospodářskými odvětvími • posoudit  vliv průměrného příjmu na dostupnost vybraných kategorií potravin• ověřit hypotézu, že výše HDP má vliv na změnu mezd a cen potravin. Hlavní výzkumné otázky: 1. Rostou v průběhu let mzdy ve všech odvětvích, nebo v některých klesají?2. Kolik je možné si koupit litrů mléka a kilogramů chleba za první a poslední srovnatelné období v dostupných datech cen a mezd?3. Která kategorie potravin zdražuje nejpomaleji (je u ní nejnižší percentuální meziroční nárůst)?4. Existuje rok, ve kterém byl meziroční nárůst cen potravin výrazně vyšší než růst mezd (větší než 10 %)?5. Má výška HDP vliv na změny ve mzdách a cenách potravin? Neboli, pokud HDP vzroste výrazněji v jednom roce, projeví se to na cenách potravin či mzdách ve stejném nebo následujícím roce výraznějším růstem?Dataset a tabulky:Použitá data pocházejí z veřejných zdrojů, z Portálu otevřených dat ČR a zahrnují:1. Hlavní tabulka: t_cathy_markova_project_sql_primary_final Obsahuje  dataa o mzdách a cenách za sledované období v České republice:• payroll_year – rok výplaty mezd• industry – hospodářské odvětví• average_wages – průměrná hrubá mzda v tis. Kč• food_code – kód kategorie potravin• food_category – název kategorie potravin• food_price – průměrná cena dané kategorie potravin• price_value – počet měrné jednotky ceny, např. 1• price_unit – měrná jednotka ceny, např. kg• price_measured from, price_measured_to – počáteční a konečné datum měření ceny2.  Sekundární  tabulka: t_cathy_markova_project_sql_secondary_final –Obsahuje doplňující ekonomické údaje :• GDP – hrubý domácí produkt• GINI – statistická míra nerovnosti v rozdělení příjmů nebo bohatství v určité populaci• population – počet obyvatelstvaUkázka použitého SQL skriptu:--- otázka č.1: Rostou v průběhu let mzdy ve všech odvětvích, nebo v některých klesají?selectpayroll_year,industry,    AVG(average_wages) AS average_wage,    LAG(AVG(average_wages)) OVER (PARTITION BY industry ORDER BY payroll_year) AS previous_year_wages,    ((AVG(average_wages) - LAG(AVG(average_wages)) OVER (PARTITION BY industry ORDER BY payroll_year)) /     nullif(LAG(AVG(average_wages)) OVER (PARTITION BY industry ORDER BY payroll_year) * 100)) AS wage_growth_percentage,    case     	when (AVG(average_wages) - LAG(AVG(average_wages)) OVER (PARTITION BY industry ORDER BY payroll_year))   > 0 then 'growth'    	else 'decline'    end as trend      FROM t_katerina_markova_project_sql_primary_final tmpfGROUP BY payroll_year, industryORDER BY industry, payroll_year;WITH cte_wage_analysis AS ( -- analýza vývoje mezd    SELECT        payroll_year,        industry,        round(AVG(average_wages) :: numeric) AS average_wage,        round(LAG(AVG(average_wages)) OVER (PARTITION BY industry             ORDER BY payroll_year        ) :: numeric) AS previous_year_wages,       round((AVG(average_wages) - LAG(AVG(average_wages)) OVER (            PARTITION BY industry             ORDER BY payroll_year        )) / LAG(AVG(average_wages)) OVER (            PARTITION BY industry             ORDER BY payroll_year        ) * 100, 3) AS wage_growth_percentage,        CASE             WHEN (AVG(average_wages) - LAG(AVG(average_wages)) OVER (                PARTITION BY industry                 ORDER BY payroll_year            )) > 0 THEN 'growth'            ELSE 'decline'        END AS trend    FROM t_katerina_markova_project_sql_primary_final tmpf    GROUP BY payroll_year, industry)SELECT *FROM cte_wage_analysisWHERE previous_year_wages IS NOT NULLORDER BY trend, industry, payroll_year;Metodologie analýzyAnalýza byla provedena pomocí SQL dotazovacího jazyka s využitím relační databáze. Použité techniky: 1. Časové porovnání dat• Využití LAG() a LEAD() pro porovnání hodnot mezi jednotlivými roky.• AVG() pro výpočet průměrných hodnot mezd a cen potravin.• EXTRACT(YEAR FROM date_column) pro seskupení dat podle roků.2. Vývoj mezd v odvětvích• PARTITION BY industry s LAG() k porovnání meziročních změn.• CASE WHEN pro kategorizaci na "growth" (růst) a "decline" (pokles).3. Koupěschopnost obyvatelstva• Výpočet kupní síly (FLOOR(average_wage / avg_food_price)).4. Identifikace nejpomalejšího růstu cen potravin• ROW_NUMBER() OVER (PARTITION BY food_category ORDER BY percentage_price_change ASC) pro určení nejnižšího růstu cen.5. Vliv HDP na mzdy a ceny potravin• Spojení tabulek t_cathy_markova_project_sql_primary_final a t_cathy_markova_project_sql_secondary_final.• Výpočet meziročního růstu HDP pomocí LAG() a porovnání s růstem mezd a cen.Struktura výstupního souboru Výstupní soubor má podobu SQL skriptu generujícího vstupní tabulky, mezivýsledky i výsledné tabulky.Shrnutí hlavních zjištění• Mzdy dlouhodobě rostou ve všech sledovaných odvětvích, ale v některých letech dochází ke krátkodobým poklesům. •  Koupěschopnost se zvýšila – v roce 2018 bylo možné koupit více mléka i chleba než v roce 2006. • Nejmenší meziroční růst měla kategorie jakostního bílého vína (2,70 % ročně). Největší pokles cen zaznamenala rajčata červená kulatá v roce 2017 (-30,28 %).• Ve sledovaném období nikdy nedošlo k růstu cen potravin o více než 10 % nad růst mezd. • Růst HDP má určitou souvislost s růstem mezd, ale ne vždy se projeví ve stejném roce.Možná omezení a doporučení• Analýza vlivu HDP na mzdy a ceny byla možná pouze pro ČR kvůli nedostupnosti dat pro jiné země.• Budoucí výzkum by mohl zahrnout širší ekonomické faktory, například inflaci nebo změny v produktivitě práce.Autor:Kateřina Marková